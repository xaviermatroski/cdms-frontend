<!-- Page Header -->
<div class="page-header">
  <h1 class="page-title">Access Policies</h1>
  <a href="/policies/create" class="btn btn-primary">
    <i class="fas fa-plus"></i> Create Policy
  </a>
</div>

<!-- Info Banner -->
<div style="background-color: #f0f9ff; border-left: 4px solid #059669; padding: 16px; border-radius: 4px; margin-bottom: 20px;">
  <p style="margin: 0; font-size: 13px; color: #065f46;"><i class="fas fa-info-circle"></i> Policies control who can access records based on organization and role</p>
</div>

<!-- Policies Table -->
<div class="card">
  <div class="card-header">
    <h3 class="card-title">All Policies (<%= policies.length %>)</h3>
  </div>
  <% if (policies.length === 0) { %>
    <div style="padding: 40px 20px; text-align: center; color: #9ca3af;">
      <i class="fas fa-shield-alt" style="font-size: 32px; margin-bottom: 10px; display: block;"></i>
      <p>No policies found. <a href="/policies/create" style="color: var(--primary);">Create one</a></p>
    </div>
  <% } else { %>
    <div style="overflow-x: auto;">
      <table>
        <thead>
          <tr>
            <th>Policy ID</th>
            <th>Categories</th>
            <th>Allowed Organizations</th>
            <th>Allowed Roles</th>
            <th>Created</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          <% policies.forEach(policy => { %>
            <tr>
              <td><strong><%= policy.policyId %></strong></td>
              <td>
                <% policy.categories.forEach(cat => { %>
                  <span class="badge badge-success" style="margin-right: 5px; margin-bottom: 5px;"><%= cat %></span>
                <% }); %>
              </td>
              <td>
                <% policy.allowedOrgs.forEach(org => { %>
                  <span style="display: inline-block; background-color: #e5e7eb; color: #374151; padding: 4px 8px; border-radius: 3px; font-size: 12px; margin-right: 5px; margin-bottom: 5px;"><%= org %></span>
                <% }); %>
              </td>
              <td>
                <% policy.allowedRoles.forEach(role => { %>
                  <span style="display: inline-block; background-color: #f0f4ff; color: #1e3a8a; padding: 4px 8px; border-radius: 3px; font-size: 12px; margin-right: 5px; margin-bottom: 5px;"><%= role %></span>
                <% }); %>
              </td>
              <td style="font-size: 13px; color: #6b7280;">
                <%= new Date(policy.createdAt).toLocaleDateString() %>
              </td>
              <td>
                <a href="/policies/<%= policy.policyId %>" style="color: var(--primary); text-decoration: none; margin-right: 10px;">View</a>
                <a href="/policies/<%= policy.policyId %>/delete" onclick="return confirm('Are you sure?');" style="color: #dc2626; text-decoration: none;">Delete</a>
              </td>
            </tr>
          <% }); %>
        </tbody>
      </table>
    </div>
  <% } %>
</div>
